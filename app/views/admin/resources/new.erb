<div class="row justify-content-md-center">
  <div class="col-lg-8 col-md-12">
    <div class="alert alert-primary border my-4" role="alert">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb m-0">
          <li class="breadcrumb-item"><%= link_to 'Administration', admin_index_path %></li>
          <li class="breadcrumb-item active"><%= link_to 'Ressources', admin_resources_path %></li>
        </ol>
      </nav>
    </div>
  </div>
</div>

<div class="row justify-content-md-center">
  <div class="col-lg-5 col-md-6">
    <%= form_with(model: @resource, url: admin_resources_path) do |f| %>
    <div class="card">
      <h5 class="card-header">Crée une ressource</h5>
      <div class="card-body">
        <%= f.label 'Étiquette', class: 'mt-1' %>
        <%= f.select :label_id, Label.order(:name).all.map {|l| [l.name, l.id] }, { include_blank: true} , { 'data-live-search': 'true', 'data-style': 'btn-white', class: 'selectPicker border w-100 mt-1 rounded', required: :required }%>

        <%= f.label 'Projet', class: 'mt-1' %>
        <%= f.select :projet_id, Projet.order(:name).all.map {|p| [p.name, p.id] }, { include_blank: true }, { class: 'form-select mt-1', required: :required }%>

        <%= f.label 'Catégorie', class: 'mt-1' %>
        <%= f.select :category_id, Category.order(:name).all.map {|c| [c.name, c.id] }, { include_blank: true }, { class: 'form-select mt-1', required: :required  }%>

        <%= f.label 'Format', class: 'mt-1' %>
        <% grouped_options = Format.order(:group).distinct.pluck(:group).map { |g| [g, Format.where(group: g).map {|fo| [fo.name, fo.id, {'data-code': fo.code}] }] } %>
        <%= f.select :format_id, grouped_options_for_select(grouped_options), { include_blank: true }, { class: 'form-select mt-1', required: :required }%>

        <%= f.label 'Langue', class: 'mt-1' %>
        <% languages_options = LanguageList::ALL_LANGUAGES.map { |l| ["#{l.iso_639_3.upcase} - #{l.name}", l.iso_639_3.upcase] }.append(['XXX - Unknown', 'XXX']) %>
        <%= f.select :code_language, languages_options, { include_blank: true }, { 'data-live-search': 'true', 'data-style': 'btn-white', class: 'selectPicker border w-100 mt-1 rounded', required: :required }%>

        <%= f.label 'Numéro', class: 'mt-1' %>
        <%= f.select :code_number, (1..1000).map {|n| "%.4i" % n}, { include_blank: true, selected: '0001'}, { class: 'form-select mt-1', required: :required }%>

        <div class="ressource-translation d-none">
          <%= f.label 'Traduction', class: 'mt-1' %>
          <%= f.text_field :translation, class: 'form-control mt-1', minlength: 2, required: :required  %>
          <%= f.button :submit, class: 'btn btn-success mt-3' do %>
          <i class="fas fa-check"> Valider</i>
          <% end %>
        </div>
        <div class="ressource-upload">
          <%= f.label 'Fichier', class: 'mt-1' %>
          <%= f.file_field nil, class: 'form-control mt-1', minlength: 2, disabled: :disabled %>
          <%= f.button :submit, class: 'btn btn-success mt-3' do %>
          <i class="fas fa-check"> Valider</i>
          <% end %>
        </div>
      </div>
    </div>
    <% end %>
  </div>
</div>
